<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee System Admin</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: #2c3e50; color: white; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: white; padding: 15px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #ddd; cursor: pointer; margin-right: 5px; border-radius: 5px 5px 0 0; }
        .tab.active { background: white; }
        .tab-content { display: none; background: white; padding: 20px; border-radius: 0 5px 5px 5px; }
        .tab-content.active { display: block; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        .status-confirmed { color: #3498db; }
        .status-preparing { color: #f39c12; }
        .status-delivered { color: #27ae60; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>☕ Coffee System Admin</h1>
            <p>Панель управління системою замовлення кави</p>
        </div>

        <div class="stats" id="stats">
            <div class="stat-card">
                <h3>👤 Користувачі</h3>
                <p id="totalUsers">0</p>
            </div>
            <div class="stat-card">
                <h3>📦 Замовлення</h3>
                <p id="totalOrders">0</p>
            </div>
            <div class="stat-card">
                <h3>☕ Позиції</h3>
                <p id="totalMenuItems">0</p>
            </div>
            <div class="stat-card">
                <h3>💰 Сьогодні</h3>
                <p id="todayRevenue">0 грн</p>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('orders')">📦 Замовлення</div>
            <div class="tab" onclick="showTab('menu')">☕ Меню</div>
            <div class="tab" onclick="showTab('users')">👤 Користувачі</div>
        </div>

        <div id="orders-tab" class="tab-content active">
            <h2>Останні замовлення</h2>
            <table id="ordersTable">
                <thead>
                    <tr>
                        <th>№</th>
                        <th>Статус</th>
                        <th>Сума</th>
                        <th>Дата</th>
                        <th>Дії</th>
                    </tr>
                </thead>
                <tbody id="ordersBody"></tbody>
            </table>
        </div>

        <div id="menu-tab" class="tab-content">
            <h2>Управління меню</h2>
            <button onclick="showAddMenuItemForm()">➕ Додати позицію</button>
            <table>
                <thead>
                    <tr>
                        <th>Назва</th>
                        <th>Категорія</th>
                        <th>Ціна</th>
                        <th>Статус</th>
                        <th>Дії</th>
                    </tr>
                </thead>
                <tbody id="menuBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api/v1';
        let authToken = '';

        // Функції для роботи з API
        async function apiCall(url, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${url}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': authToken ? `Bearer ${authToken}` : '',
                        ...options.headers
                    },
                    ...options
                });
                return await response.json();
            } catch (error) {
                console.error('API помилка:', error);
            }
        }

        // Завантаження статистики
        async function loadStats() {
            const data = await apiCall('/admin/stats');
            if (data.success) {
                document.getElementById('totalUsers').textContent = data.data.stats.total.users;
                document.getElementById('totalOrders').textContent = data.data.stats.total.orders;
                document.getElementById('totalMenuItems').textContent = data.data.stats.total.menuItems;
                document.getElementById('todayRevenue').textContent = data.data.stats.today.revenue + ' грн';
            }
        }

        // Завантаження замовлень
        async function loadOrders() {
            const data = await apiCall('/admin/orders');
            if (data.success) {
                const tbody = document.getElementById('ordersBody');
                tbody.innerHTML = data.data.orders.map(order => `
                    <tr>
                        <td>${order.orderNumber}</td>
                        <td class="status-${order.status}">${order.status}</td>
                        <td>${order.totalAmount} грн</td>
                        <td>${new Date(order.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button onclick="updateOrderStatus('${order.id}', 'preparing')">Готується</button>
                            <button onclick="updateOrderStatus('${order.id}', 'delivered')">Доставлено</button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        // Покажемо адмін інтерфейс
        function showAdminInterface() {
            loadStats();
            loadOrders();
            setInterval(loadStats, 30000); // Оновлюємо кожні 30 секунд
        }

        // Спрощена версія - без автентифікації для демонстрації
        showAdminInterface();
    </script>
</body>
</html>
